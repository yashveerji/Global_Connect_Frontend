{"ast":null,"code":"// ✅ src/store/userSlice.js\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\n// 🔁 Replace with your actual backend base URL\nconst API = \"https://global-connect-p93z.onrender.com/api\";\n\n// 🔐 Register User\nexport const registerUser = createAsyncThunk(\"user/register\", async (userData, thunkAPI) => {\n  try {\n    const res = await axios.post(`${API}/auth/register`, userData);\n    return res.data;\n  } catch (err) {\n    var _err$response, _err$response$data;\n    return thunkAPI.rejectWithValue(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.msg) || \"Registration failed\");\n  }\n});\n\n// 🔐 Login User\nexport const loginUser = createAsyncThunk(\"user/login\", async (credentials, thunkAPI) => {\n  try {\n    const res = await axios.post(`${API}/auth/login`, credentials);\n    localStorage.setItem(\"token\", res.data.token);\n    localStorage.setItem(\"user\", JSON.stringify(res.data.user)); // ✅ save user\n    return res.data;\n  } catch (err) {\n    var _err$response2, _err$response2$data;\n    return thunkAPI.rejectWithValue(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.msg) || \"Login failed\");\n  }\n});\n\n// 🔁 Slice\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    user: JSON.parse(localStorage.getItem(\"user\")) || null,\n    token: localStorage.getItem(\"token\") || null,\n    loading: false,\n    error: null\n  },\n  reducers: {\n    // ✅ Restore login on refresh\n    loginUserSuccess: (state, action) => {\n      state.user = action.payload.user;\n      state.token = action.payload.token;\n    },\n    logout: state => {\n      state.user = null;\n      state.token = null;\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"user\");\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(registerUser.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(registerUser.fulfilled, (state, action) => {\n      state.loading = false;\n      state.user = action.payload.user;\n    }).addCase(registerUser.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    }).addCase(loginUser.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(loginUser.fulfilled, (state, action) => {\n      state.loading = false;\n      state.user = action.payload.user;\n      state.token = action.payload.token;\n    }).addCase(loginUser.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    });\n  }\n});\nexport const {\n  logout,\n  loginUserSuccess\n} = userSlice.actions;\nexport default userSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","API","registerUser","userData","thunkAPI","res","post","data","err","_err$response","_err$response$data","rejectWithValue","response","msg","loginUser","credentials","localStorage","setItem","token","JSON","stringify","user","_err$response2","_err$response2$data","userSlice","name","initialState","parse","getItem","loading","error","reducers","loginUserSuccess","state","action","payload","logout","removeItem","extraReducers","builder","addCase","pending","fulfilled","rejected","actions","reducer"],"sources":["C:/Users/yashv/OneDrive/Desktop/Internshipmini2/Global_Connect/Global_Connect/frontend/src/store/userSlice.js"],"sourcesContent":["// ✅ src/store/userSlice.js\r\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\n\r\n// 🔁 Replace with your actual backend base URL\r\nconst API = \"https://global-connect-p93z.onrender.com/api\";\r\n\r\n// 🔐 Register User\r\nexport const registerUser = createAsyncThunk(\r\n  \"user/register\",\r\n  async (userData, thunkAPI) => {\r\n    try {\r\n      const res = await axios.post(`${API}/auth/register`, userData);\r\n      return res.data;\r\n    } catch (err) {\r\n      return thunkAPI.rejectWithValue(err.response?.data?.msg || \"Registration failed\");\r\n    }\r\n  }\r\n);\r\n\r\n// 🔐 Login User\r\nexport const loginUser = createAsyncThunk(\r\n  \"user/login\",\r\n  async (credentials, thunkAPI) => {\r\n    try {\r\n      const res = await axios.post(`${API}/auth/login`, credentials);\r\n      localStorage.setItem(\"token\", res.data.token);\r\n      localStorage.setItem(\"user\", JSON.stringify(res.data.user)); // ✅ save user\r\n      return res.data;\r\n    } catch (err) {\r\n      return thunkAPI.rejectWithValue(err.response?.data?.msg || \"Login failed\");\r\n    }\r\n  }\r\n);\r\n\r\n// 🔁 Slice\r\nconst userSlice = createSlice({\r\n  name: \"user\",\r\n  initialState: {\r\n    user: JSON.parse(localStorage.getItem(\"user\")) || null,\r\n    token: localStorage.getItem(\"token\") || null,\r\n    loading: false,\r\n    error: null,\r\n  },\r\n  reducers: {\r\n    // ✅ Restore login on refresh\r\n    loginUserSuccess: (state, action) => {\r\n      state.user = action.payload.user;\r\n      state.token = action.payload.token;\r\n    },\r\n    logout: (state) => {\r\n      state.user = null;\r\n      state.token = null;\r\n      localStorage.removeItem(\"token\");\r\n      localStorage.removeItem(\"user\");\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(registerUser.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(registerUser.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.user = action.payload.user;\r\n      })\r\n      .addCase(registerUser.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      .addCase(loginUser.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(loginUser.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.user = action.payload.user;\r\n        state.token = action.payload.token;\r\n      })\r\n      .addCase(loginUser.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      });\r\n  },\r\n});\r\n\r\nexport const { logout, loginUserSuccess } = userSlice.actions;\r\nexport default userSlice.reducer;\r\n"],"mappings":"AAAA;AACA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,KAAK,MAAM,OAAO;;AAEzB;AACA,MAAMC,GAAG,GAAG,8CAA8C;;AAE1D;AACA,OAAO,MAAMC,YAAY,GAAGH,gBAAgB,CAC1C,eAAe,EACf,OAAOI,QAAQ,EAAEC,QAAQ,KAAK;EAC5B,IAAI;IACF,MAAMC,GAAG,GAAG,MAAML,KAAK,CAACM,IAAI,CAAC,GAAGL,GAAG,gBAAgB,EAAEE,QAAQ,CAAC;IAC9D,OAAOE,GAAG,CAACE,IAAI;EACjB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAC,aAAA,EAAAC,kBAAA;IACZ,OAAON,QAAQ,CAACO,eAAe,CAAC,EAAAF,aAAA,GAAAD,GAAG,CAACI,QAAQ,cAAAH,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcF,IAAI,cAAAG,kBAAA,uBAAlBA,kBAAA,CAAoBG,GAAG,KAAI,qBAAqB,CAAC;EACnF;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAMC,SAAS,GAAGf,gBAAgB,CACvC,YAAY,EACZ,OAAOgB,WAAW,EAAEX,QAAQ,KAAK;EAC/B,IAAI;IACF,MAAMC,GAAG,GAAG,MAAML,KAAK,CAACM,IAAI,CAAC,GAAGL,GAAG,aAAa,EAAEc,WAAW,CAAC;IAC9DC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEZ,GAAG,CAACE,IAAI,CAACW,KAAK,CAAC;IAC7CF,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEE,IAAI,CAACC,SAAS,CAACf,GAAG,CAACE,IAAI,CAACc,IAAI,CAAC,CAAC,CAAC,CAAC;IAC7D,OAAOhB,GAAG,CAACE,IAAI;EACjB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAc,cAAA,EAAAC,mBAAA;IACZ,OAAOnB,QAAQ,CAACO,eAAe,CAAC,EAAAW,cAAA,GAAAd,GAAG,CAACI,QAAQ,cAAAU,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcf,IAAI,cAAAgB,mBAAA,uBAAlBA,mBAAA,CAAoBV,GAAG,KAAI,cAAc,CAAC;EAC5E;AACF,CACF,CAAC;;AAED;AACA,MAAMW,SAAS,GAAG1B,WAAW,CAAC;EAC5B2B,IAAI,EAAE,MAAM;EACZC,YAAY,EAAE;IACZL,IAAI,EAAEF,IAAI,CAACQ,KAAK,CAACX,YAAY,CAACY,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,IAAI;IACtDV,KAAK,EAAEF,YAAY,CAACY,OAAO,CAAC,OAAO,CAAC,IAAI,IAAI;IAC5CC,OAAO,EAAE,KAAK;IACdC,KAAK,EAAE;EACT,CAAC;EACDC,QAAQ,EAAE;IACR;IACAC,gBAAgB,EAAEA,CAACC,KAAK,EAAEC,MAAM,KAAK;MACnCD,KAAK,CAACZ,IAAI,GAAGa,MAAM,CAACC,OAAO,CAACd,IAAI;MAChCY,KAAK,CAACf,KAAK,GAAGgB,MAAM,CAACC,OAAO,CAACjB,KAAK;IACpC,CAAC;IACDkB,MAAM,EAAGH,KAAK,IAAK;MACjBA,KAAK,CAACZ,IAAI,GAAG,IAAI;MACjBY,KAAK,CAACf,KAAK,GAAG,IAAI;MAClBF,YAAY,CAACqB,UAAU,CAAC,OAAO,CAAC;MAChCrB,YAAY,CAACqB,UAAU,CAAC,MAAM,CAAC;IACjC;EACF,CAAC;EACDC,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAACtC,YAAY,CAACuC,OAAO,EAAGR,KAAK,IAAK;MACxCA,KAAK,CAACJ,OAAO,GAAG,IAAI;MACpBI,KAAK,CAACH,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDU,OAAO,CAACtC,YAAY,CAACwC,SAAS,EAAE,CAACT,KAAK,EAAEC,MAAM,KAAK;MAClDD,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACZ,IAAI,GAAGa,MAAM,CAACC,OAAO,CAACd,IAAI;IAClC,CAAC,CAAC,CACDmB,OAAO,CAACtC,YAAY,CAACyC,QAAQ,EAAE,CAACV,KAAK,EAAEC,MAAM,KAAK;MACjDD,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACH,KAAK,GAAGI,MAAM,CAACC,OAAO;IAC9B,CAAC,CAAC,CACDK,OAAO,CAAC1B,SAAS,CAAC2B,OAAO,EAAGR,KAAK,IAAK;MACrCA,KAAK,CAACJ,OAAO,GAAG,IAAI;MACpBI,KAAK,CAACH,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDU,OAAO,CAAC1B,SAAS,CAAC4B,SAAS,EAAE,CAACT,KAAK,EAAEC,MAAM,KAAK;MAC/CD,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACZ,IAAI,GAAGa,MAAM,CAACC,OAAO,CAACd,IAAI;MAChCY,KAAK,CAACf,KAAK,GAAGgB,MAAM,CAACC,OAAO,CAACjB,KAAK;IACpC,CAAC,CAAC,CACDsB,OAAO,CAAC1B,SAAS,CAAC6B,QAAQ,EAAE,CAACV,KAAK,EAAEC,MAAM,KAAK;MAC9CD,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACH,KAAK,GAAGI,MAAM,CAACC,OAAO;IAC9B,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEC,MAAM;EAAEJ;AAAiB,CAAC,GAAGR,SAAS,CAACoB,OAAO;AAC7D,eAAepB,SAAS,CAACqB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}