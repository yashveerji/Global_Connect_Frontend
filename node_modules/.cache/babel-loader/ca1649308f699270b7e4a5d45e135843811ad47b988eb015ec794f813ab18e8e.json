{"ast":null,"code":"import React,{useEffect,useState,useCallback}from\"react\";import axios from\"axios\";import{useSelector}from\"react-redux\";import{toast}from\"react-toastify\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Connections=()=>{const{user,token}=useSelector(state=>state.user);const[allUsers,setAllUsers]=useState([]);const[connections,setConnections]=useState([]);const[pending,setPending]=useState([]);const[search,setSearch]=useState(\"\");const[debouncedSearch,setDebouncedSearch]=useState(\"\");const API=process.env.REACT_APP_API_URL;// Debounce search\nuseEffect(()=>{const timer=setTimeout(()=>setDebouncedSearch(search),400);return()=>clearTimeout(timer);},[search]);const fetchData=useCallback(async()=>{try{const usersRes=await axios.get(`${API}/users`,{headers:{Authorization:token}});setAllUsers(usersRes.data);const connRes=await axios.get(`${API}/connections/list`,{headers:{Authorization:token}});setConnections(connRes.data.map(u=>u._id));const pendingRes=await axios.get(`${API}/connections/pending`,{headers:{Authorization:token}});setPending(pendingRes.data.map(u=>u._id));}catch(err){console.error(\"‚ùå Error fetching connections:\",err);toast.error(\"Failed to load connections\");}},[API,token]);useEffect(()=>{fetchData();},[fetchData]);const handleConnect=async toUserId=>{try{await axios.post(`${API}/connections/send`,{toUserId},{headers:{Authorization:token}});toast.success(\"Connection request sent!\");setPending(prev=>[...prev,toUserId]);}catch(err){console.error(\"‚ùå Error sending request:\",err);toast.error(\"Request failed\");}};const filteredUsers=allUsers.filter(u=>u._id!==user._id).filter(u=>u.name.toLowerCase().includes(debouncedSearch.toLowerCase())||u.email.toLowerCase().includes(debouncedSearch.toLowerCase()));const renderButton=id=>{if(connections.includes(id))return/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center gap-1 text-green-600 font-semibold\",children:\"\\u2705 Connected\"});if(pending.includes(id))return/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center gap-1 text-yellow-600 font-semibold\",children:\"\\u23F3 Pending\"});return/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleConnect(id),className:\"px-4 py-2 bg-indigo-600 text-white rounded-lg shadow hover:bg-indigo-700 transition\",children:\"Connect\"});};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-3xl mx-auto p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-center mb-6 text-indigo-700 tracking-wide\",children:\"\\uD83D\\uDD17 Connections\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:search,placeholder:\"Search users by name or email...\",onChange:e=>setSearch(e.target.value),className:\"w-full mb-6 px-4 py-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition shadow-sm\"}),filteredUsers.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 text-lg mt-12\",children:\"No users found\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:filteredUsers.map(u=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-5 flex items-center justify-between shadow-md hover:shadow-lg transition\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 rounded-full bg-indigo-500 text-white flex items-center justify-center text-xl font-bold select-none\",children:u.name.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold text-gray-800\",children:u.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:u.email})]})]}),/*#__PURE__*/_jsx(\"div\",{children:renderButton(u._id)})]},u._id))})]});};export default Connections;","map":{"version":3,"names":["React","useEffect","useState","useCallback","axios","useSelector","toast","jsx","_jsx","jsxs","_jsxs","Connections","user","token","state","allUsers","setAllUsers","connections","setConnections","pending","setPending","search","setSearch","debouncedSearch","setDebouncedSearch","API","process","env","REACT_APP_API_URL","timer","setTimeout","clearTimeout","fetchData","usersRes","get","headers","Authorization","data","connRes","map","u","_id","pendingRes","err","console","error","handleConnect","toUserId","post","success","prev","filteredUsers","filter","name","toLowerCase","includes","email","renderButton","id","className","children","onClick","type","value","placeholder","onChange","e","target","length","charAt","toUpperCase"],"sources":["C:/Users/yashv/OneDrive/Desktop/Internshipmini2/Global_Connect/Global_Connect/frontend/src/components/Connections.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst Connections = () => {\r\n  const { user, token } = useSelector((state) => state.user);\r\n  const [allUsers, setAllUsers] = useState([]);\r\n  const [connections, setConnections] = useState([]);\r\n  const [pending, setPending] = useState([]);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [debouncedSearch, setDebouncedSearch] = useState(\"\");\r\n\r\n  const API = process.env.REACT_APP_API_URL;\r\n\r\n  // Debounce search\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => setDebouncedSearch(search), 400);\r\n    return () => clearTimeout(timer);\r\n  }, [search]);\r\n\r\n  const fetchData = useCallback(async () => {\r\n    try {\r\n      const usersRes = await axios.get(`${API}/users`, {\r\n        headers: { Authorization: token },\r\n      });\r\n      setAllUsers(usersRes.data);\r\n\r\n      const connRes = await axios.get(`${API}/connections/list`, {\r\n        headers: { Authorization: token },\r\n      });\r\n      setConnections(connRes.data.map((u) => u._id));\r\n\r\n      const pendingRes = await axios.get(`${API}/connections/pending`, {\r\n        headers: { Authorization: token },\r\n      });\r\n      setPending(pendingRes.data.map((u) => u._id));\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error fetching connections:\", err);\r\n      toast.error(\"Failed to load connections\");\r\n    }\r\n  }, [API, token]);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  const handleConnect = async (toUserId) => {\r\n    try {\r\n      await axios.post(\r\n        `${API}/connections/send`,\r\n        { toUserId },\r\n        { headers: { Authorization: token } }\r\n      );\r\n      toast.success(\"Connection request sent!\");\r\n      setPending((prev) => [...prev, toUserId]);\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error sending request:\", err);\r\n      toast.error(\"Request failed\");\r\n    }\r\n  };\r\n\r\n  const filteredUsers = allUsers\r\n    .filter((u) => u._id !== user._id)\r\n    .filter((u) =>\r\n      u.name.toLowerCase().includes(debouncedSearch.toLowerCase()) ||\r\n      u.email.toLowerCase().includes(debouncedSearch.toLowerCase())\r\n    );\r\n\r\n  const renderButton = (id) => {\r\n    if (connections.includes(id))\r\n      return (\r\n        <span className=\"inline-flex items-center gap-1 text-green-600 font-semibold\">\r\n          ‚úÖ Connected\r\n        </span>\r\n      );\r\n    if (pending.includes(id))\r\n      return (\r\n        <span className=\"inline-flex items-center gap-1 text-yellow-600 font-semibold\">\r\n          ‚è≥ Pending\r\n        </span>\r\n      );\r\n    return (\r\n      <button\r\n        onClick={() => handleConnect(id)}\r\n        className=\"px-4 py-2 bg-indigo-600 text-white rounded-lg shadow hover:bg-indigo-700 transition\"\r\n      >\r\n        Connect\r\n      </button>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-3xl mx-auto p-6\">\r\n      <h2 className=\"text-3xl font-extrabold text-center mb-6 text-indigo-700 tracking-wide\">\r\n        üîó Connections\r\n      </h2>\r\n\r\n      <input\r\n        type=\"text\"\r\n        value={search}\r\n        placeholder=\"Search users by name or email...\"\r\n        onChange={(e) => setSearch(e.target.value)}\r\n        className=\"w-full mb-6 px-4 py-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition shadow-sm\"\r\n      />\r\n\r\n      {filteredUsers.length === 0 ? (\r\n        <p className=\"text-center text-gray-500 text-lg mt-12\">\r\n          No users found\r\n        </p>\r\n      ) : (\r\n        <div className=\"space-y-4\">\r\n          {filteredUsers.map((u) => (\r\n            <div\r\n              key={u._id}\r\n              className=\"bg-white rounded-xl p-5 flex items-center justify-between shadow-md hover:shadow-lg transition\"\r\n            >\r\n              <div className=\"flex items-center gap-4\">\r\n                {/* Avatar circle with initials */}\r\n                <div className=\"w-12 h-12 rounded-full bg-indigo-500 text-white flex items-center justify-center text-xl font-bold select-none\">\r\n                  {u.name.charAt(0).toUpperCase()}\r\n                </div>\r\n                <div>\r\n                  <h4 className=\"text-lg font-semibold text-gray-800\">{u.name}</h4>\r\n                  <p className=\"text-sm text-gray-500\">{u.email}</p>\r\n                </div>\r\n              </div>\r\n              <div>{renderButton(u._id)}</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Connections;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}